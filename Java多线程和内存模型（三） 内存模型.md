### Java多线程和内存模型（三） 内存模型

计算机的内存模型：
处理器  -- 高速缓存 -- 缓存一致性协议 -- 主内存
利用指令重排序，提高运行效率；


##### Java 内存模型的目的：
屏蔽掉各种硬件和操作系统的内存访问差异，以实现让 java 程序在各种平台下都能达到一致的内存访问效果；

目标： 定义程序中各个变量的访问规则；

java线程 -- 工作内存 -- Save 和 Load 操作 -- 主内存；

工作内存：保存了该线程中使用到的变量从主内存中的拷贝，线程对变量的所有操作必须在工作内存中进行；不同 线程之间也无法直接访问对方工作内存中的变量，线程间变量值的传递均需要通过 主内存来完成。


##### 内存间的交互操作，定义了8种原子性操作；
+ lock（锁定） ： 作用于主内存变量，把一个变量标识为一条线程独占的状态；
+ unlock （解锁）： 作用主内存，把一个在锁定状态的变量释放
+ read（读取） ：作用主内存，把一个变量从主内存取出到工作内存；
+ load （载入）：作用工作内存， 把 read 操作从主内存中得到的变量值放到工作内存的变量副本中
+ use (使用) ： 作用于工作内存，把工作内存中的一个变量的值传递给执行的引擎，每当虚拟机遇到一个需要使用到变量的字节码的时候，就会执行这个操作；
+ assign（赋值）：作用工作内存，把一个从执行引擎中接收到的值赋值给工作内存的变量，虚拟机遇到赋值的字节码时触发；
+ store （存储）： 把工作内存的变量传递到主内存中；
+ wirte （写入）： 把 store 操作获得的变量的值写入主内存的变量中；